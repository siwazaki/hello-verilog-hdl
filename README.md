# Verilog に関する個人的なノート

課題図書: [わかる Verilog HDL 入門](https://www.amazon.co.jp/わかるVerilog-HDL入門―文法の基礎から論理回路設計、論理合成、実装まで-トランジスタ技術SPECIAL-木村-真也/dp/4789837564)

大事そうなところ、わからなくて迷ったところだけをメモる感じ。

## 第 0 章 はじめに

開発環境のメモ

### 開発環境

- osx
- vscode + 下のプラグイン
  - Verilog HDL/SystemVerilog support for VS Code
  - Verilog Format
- icarus verilog
  - シミュレータ
- GTKWave
  - 実行結果の波形を見るツール

### コンパイル方法

```bash
iverilog -o hoge.out hoge.v
```

### シミュレータの実行方法

```bash
vvp hoge.out
```

### 波形の確認

`hoge.v`の中で dumpfile しておくと結果の波形を GTKWave で見れる。

## 第 1 章 Verilog HDL の基本文法

- ハイ インピーダンス値
  - 入力待ちの状態を表す
- データ型
  - wire
    - 単なる配線
  - reg
    - 値を保持する機能を持った信号
- 2 の補数表現
  - 2 の補数で負の数を表すと、普通に足すことで引き算できる。
- モジュール
  - 1 つの IC みたいな単位
  - IC
    - 集積回路

## 第 2 章 組合わせ回路の記述

- 組合わせ回路
  - 出力がその時点の入力信号の値のみで決まる回路
  - 記憶機能を含んでいない回路
  - 状態がないので論理式として表現可能。なので、ブール代数の理解が重要
  - #todo p.27 の組合わせ回路の基礎項目を完全に理解すること
  - Verilog では論理式の他に if 文なども使えるので、組合わせ回路をわかりやすくかける
- assign 文
  - 手続き型と違って、右辺が変わったら即、左辺に反映される
  - assign 文の記述順序は関係ない
  - reactive extension みたいなイメージだよね
- マルチプレクサ
  - ふたつ以上の入力をひとつの信号として出力する機構
- function
  - 論理回路への具体化する前の定義。template。
  - 呼び出された分だけ、組合わせ回路として具体化される。
  - 一時変数を使いたい場合は reg と宣言しなくと使えないが、内部では register ができるわけではない。
- ドント·ケア
  - 比較対象外。casex の場合は x を比較対象外とする。
- casex
  - 判定式の x の部分はどんな値にもマッチする(ドントケア)。被判定値の x, z もドントケアされるのがわかりずらい。
- 不定値(x)を条件値として使用した場合の挙動
  - x => false
  - ~x => false

## 第 3 章 フイリップフロップと応用回路の記述

- [fpga の設計は全部同じクロック(マスタークロック)で回すというのが鉄則](https://service.macnica.co.jp/library/119381)
- cs(チップセレクト)
  - チップの enable 信号
- inout
  - 同時に in と out は起こらない
- always@(hoge)と neg、posi 書かない場合は両方のケースで実行される
- ノンブロッキング代入 `<=`
  - まとめて代入が行われる構文機構
  - @always 文(begin, end)の中では基本的にはこれを用いる。
    - 電子回路は並列実行が基本だから
    - 単なる代入文だとシーケンシャルに実行される

## 第 4 章 同期式順序回路の記述

- 順序回路
  - ステート·マシン(or オートマトン), シーケンサとも呼ばれる
  - 内部状態がある
    - <=> 組合わせ回路
- 順序回路の種類
  - 同期式順序回路
    - クロックによって同期される
  - 非同期式順序回路
    - 同期されない
    - 一般的ではない。限られた用途にしか使われない
- #todo 順序回路の基礎項目を説明できるようにする
- データ通信
  - シリアル
  - パラレル
- ミーリータイプとムーアタイプ
  - ミーリータイプ
    - 出力が**現状態**と**入力**によって決まる
  - ムーアタイプ
    - 出力が**現状態**によって**のみ**決まる
    - 現状態で出力される値を保持する
    - まず現状態を出力して、その後入力によって現状態を変化させるイメージ
